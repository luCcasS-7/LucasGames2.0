<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buscaminas Moderno - Lucas Games</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      background: linear-gradient(135deg, #2c3e50, #3498db); 
      color: #fff; 
      text-align: center; 
      margin: 0; padding: 20px;
    }
    #game { max-width: 600px; margin: 0 auto; }
    h1 { font-size: 2.5em; text-shadow: 0 0 10px #e74c3c; }
    #board { 
      display: grid; grid-template-columns: repeat(10, 1fr); 
      gap: 1px; background: #34495e; padding: 10px; border-radius: 10px; 
      margin: 20px auto; max-width: 500px;
    }
    .cell { 
      width: 45px; height: 45px; background: #ecf0f1; 
      border: none; font-size: 1.5em; cursor: pointer; 
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s;
    }
    .cell:hover { background: #bdc3c7; transform: scale(1.05); }
    .cell.revealed { background: #95a5a6; cursor: default; }
    .cell.mine { background: #e74c3c !important; color: #fff; }
    .cell.flag { background: #f39c12; }
    .cell.boom { animation: explode 0.5s; }
    @keyframes explode { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); background: #e74c3c; } }
    #info { font-size: 1.5em; margin: 20px; }
    #message { font-size: 2em; margin: 20px; color: #f1c40f; }
    button { padding: 12px 30px; font-size: 1.2em; background: #e74c3c; color: white; border: none; border-radius: 8px; cursor: pointer; margin: 10px; }
    button:hover { background: #c0392b; }
  </style>
</head>
<body>
  <div id="game">
    <h1>üí£ Buscaminas Moderno üß©</h1>
    <p style="font-size:1.3em; opacity:0.9;">¬°No fumbl√©es 2026! Evita las minas üî•</p>
    <div id="info">
      Minas: <span id="minesLeft">20</span> | 
      Tiempo: <span id="time">0</span>s | 
      Movidas: <span id="moves">0</span>
    </div>
    <div id="board"></div>
    <div id="message"></div>
    <button onclick="newGame()">üîÑ Nueva Partida</button>
  </div>

  <script>
    const size = 10;
    const totalMines = 20;
    let board = [];
    let revealed = [];
    let flagged = [];
    let mines = [];
    let gameOver = false;
    let time = 0;
    let moves = 0;
    let timer;

    function initBoard() {
      board = Array(size).fill().map(() => Array(size).fill(0));
      revealed = Array(size).fill().map(() => Array(size).fill(false));
      flagged = Array(size).fill().map(() => Array(size).fill(false));
      mines = [];
      gameOver = false;
      time = 0;
      moves = 0;
      clearInterval(timer);
      updateDisplay();
    }

    function placeMines(excludeRow, excludeCol) {
      while (mines.length < totalMines) {
        const r = Math.floor(Math.random() * size);
        const c = Math.floor(Math.random() * size);
        if (r !== excludeRow || c !== excludeCol) {
          if (!mines.some(([mr, mc]) => mr === r && mc === c)) {
            mines.push([r, c]);
            for (let dr = -1; dr <= 1; dr++) {
              for (let dc = -1; dc <= 1; dc++) {
                const nr = r + dr, nc = c + dc;
                if (nr >= 0 && nr < size && nc >= 0 && nc < size) {
                  board[nr][nc]++;
                }
              }
            }
          }
        }
      }
    }

    function createBoard() {
      const boardEl = document.getElementById('board');
      boardEl.innerHTML = '';
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          const cell = document.createElement('button');
          cell.className = 'cell';
          cell.dataset.row = r;
          cell.dataset.col = c;
          cell.onclick = () => reveal(parseInt(cell.dataset.row), parseInt(cell.dataset.col));
          cell.oncontextmenu = (e) => {
            e.preventDefault();
            flag(parseInt(cell.dataset.row), parseInt(cell.dataset.col));
          };
          boardEl.appendChild(cell);
        }
      }
    }

    function reveal(row, col) {
      if (gameOver || revealed[row][col] || flagged[row][col]) return;
      moves++;
      revealed[row][col] = true;

      const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
      if (mines.some(([mr, mc]) => mr === row && mc === col)) {
        cell.classList.add('mine', 'boom');
        cell.textContent = 'üí•';
        gameOver = true;
        document.getElementById('message').textContent = '¬°BOOM! Perdiste üòµ‚Äçüí´ Era: ' + time + 's';
        revealAll();
      } else {
        cell.classList.add('revealed');
        cell.textContent = board[row][col] || '';
        if (board[row][col] === 0) {
          // Flood fill
          for (let dr = -1; dr <= 1; dr++) {
            for (let dc = -1; dc <= 1; dc++) {
              const nr = row + dr, nc = col + dc;
              if (nr >= 0 && nr < size && nc >= 0 && nc < size) {
                reveal(nr, nc);
              }
            }
          }
        }
      }
      updateDisplay();
      checkWin();
    }

    function flag(row, col) {
      if (revealed[row][col] || gameOver) return;
      flagged[row][col] = !flagged[row][col];
      const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
      cell.textContent = flagged[row][col] ? 'üö©' : '';
      cell.classList.toggle('flag', flagged[row][col]);
      updateDisplay();
    }

    function revealAll() {
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          if (mines.some(([mr, mc]) => mr === r && mc === c)) {
            const cell = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
            cell.classList.add('mine');
            cell.textContent = 'üí£';
          }
        }
      }
    }

    function checkWin() {
      let revealedCount = 0;
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          if (revealed[r][c]) revealedCount++;
        }
      }
      if (revealedCount + totalMines === size * size) {
        gameOver = true;
        const high = localStorage.getItem('minesweeperHigh') || 999;
        if (time < high) {
          localStorage.setItem('minesweeperHigh', time);
        }
        document.getElementById('message').textContent = `¬°GANASTE! üéâ ${time}s (High: ${Math.min(time, high)}s)`;
      }
    }

    function updateDisplay() {
      document.getElementById('minesLeft').textContent = totalMines - flagged.filter(row => row.some(f => f)).flat().filter(f => f).length;
      document.getElementById('time').textContent = time;
      document.getElementById('moves').textContent = moves;
    }

    function newGame() {
      initBoard();
      createBoard();
      document.getElementById('message').textContent = '';
      // First click safe
      document.querySelectorAll('.cell').forEach(cell => {
        cell.onclick = () => {
          const row = parseInt(cell.dataset.row);
          const col = parseInt(cell.dataset.col);
          placeMines(row, col);
          reveal(row, col);
          cell.onclick = null; // Remove first click handler
        };
      });
      timer = setInterval(() => {
        if (!gameOver) {
          time++;
          updateDisplay();
        }
      }, 1000);
    }

    // Start
    newGame();
  </script>
<div style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
    <a href="index.html" style="background: linear-gradient(45deg, #00c6ff, #0072ff); color: white; border: none; padding: 12px 18px; border-radius: 25px; cursor: pointer; font-size: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); text-decoration: none; font-weight: bold;">üè† Volver al Men√∫</a>
</div>
</body>
</html>